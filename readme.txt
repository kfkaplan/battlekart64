================================================
Battle Kart 64
Version 3.0

by Triclon

The latest version of Battle Kart 64 can always be found on romhacking.net:
https://www.romhacking.net/hacks/5618/

Special thanks to DeadHamster for helping with bot pathfinding, getting in course objects working for Capture The Flag and Keep Away game modes, along with many more things.  Also thanks to everyone who has tested out Battle Kart 64 and provided useful feedback.
================================================

Questions, comments, or found a bug?
Email me at triclon@gmail.com

Want to keep up on the latest Mario Kart 64 hacking scoop? Join the OverKart 64 Discord 
https://discord.gg/7dKKsnr4yU
Be sure to checkout the #battlekart-64 channel!

Visit my YouTube channel: https://www.youtube.com/user/triclon

Visit my website: https://triclon.neocities.org

================================================

WHAT IS BATTLE KART 64?

Battle Kart 64 is a rom hack that greatly expands the functionality of Battle Mode in Mario Kart 64.  Many new features are added including new game modes, CPU bots, item toggling, battle on race courses, and much more!  It will run on console using a flash cart (Expansion Pak required), and on most emulators.

================================================

HOW TO PATCH

-You will need a USA/NTSC Mario Kart 64 rom in the .z64 format
-The easiest way to patch the rom is to go to https://www.romhacking.net/hacks/5618/ and scroll down and click "Patch Online Now"
- You can also apply the .bps patch to a (USA/NTSC) Mario Kart 64 rom that is in .z64 format using your own patching utility or one of the following fine online Patchers:
https://www.romhacking.net/patch/
https://hack64.net/tools/patcher.php
- Some emulators can also soft patch a .bps file to a vanilla rom

================================================

WHAT'S NEW IN VERSION 3.0?
-Highly modified CPU bot AI now with pathfinding so they can go up/down ramps, drop from above, grab item boxes, and avoid walls and cliffs.
-New game modes Zombombs and Shell Shooter.
-Updates to the scoring system.  Points are now scored based on who hit who.
-Race course driving and handling now is the same as during a race.  Previously the race courses used battle mode handling which felt off.
-Now you can select which character each bot is in the Battle Kart 64 menu.
-Battle Kart 64 menu now looks nicer and is easily accessible from the main game menu by pressing R.
-Moved graphics options to their own menu tab.
-Improvements to 60 FPS mode.
-Many other minor bug fixes, improvements, tweaks, and adjustments.

WHAT'S NEW IN VERSION 2.1?
This is a minor release mostly to fix various bugs:
-Single flags in Capture the Flag and Keep Away modes will now spawn in semi-random locations instead of always at the center of the course
-Item boxes will now be the correct height on flattened race courses, no more need for auto items
-Fixed bug where 3 player matches crashed on the results screen
-Fixed bug where course music in 3/4 player games, when the option was enabled, played over the music on the results screen
-The menu settings will now save so you don't have to change all the settings every time you turn on the console
-Various other minor tweaks and optimizations

WHAT'S NEW IN VERSION 2.0?
-New game modes Capture The Flag and Keep Away
-Improved CPU bot AI
-More CPU bot options
-Item boxes now work correctly in flat courses
-Changing courses when on a race course goes back to the correct menu
-Other various optimizations and bug fixes

================================================

HOW TO PLAY 

On the title screen, Player 1 can use the control stick or D-pad in the menu.  Select the settings you want in the menu (see below) then press start. You can always come back to the title screen to adjust settings in the menu.  To start a battle course, select 2, 3, or 4 player Battle.  To start battle mode in a race course, select 2, 3, or 4 player VS.  All CCs and Extra mode are available.

================================================

GAME MODES

Traditional:
This battle mode is the same as the unmodified game.  Each hit counts as damage against you.

Hot Potato:
This is a twist on the traditional battle mode.  In Hot Potato, there is a countdown timer, the length of which can be set in the menu.  The last person hit becomes the "hot potato."  They will start smoking and a countdown timer will appear below them.  If anyone else is hit, the hot potato status and timer will pass to them.  Whoever is the hot potato when the timer reaches zero takes damage.  If you are the hot potato, you want to hit someone else before the timer runs out.  If you are not the hot potato, you want to play defensively to avoid getting hit or attack the hot potato to try to slow them down.

Squish:
Squish is very similar to traditional battle, except when a player is hit, they will shrink as if hit by the lightning bolt.  When shrunk, they will move slower and other players will have a limited time to run them over and damage them.  To damage a player, you must first hit them with an item to shrink them, and then run them over.  If two shrunken players collide, they will both take damage.  TIP!  It is tempting to continue to use items against a player that is already shrunk, but additional hits only reset the shrink timer.  To damage a player, you must run them over after they are shrunk.  This makes Squish mode a bit more strategic.

Capture The Flag:
In this mode each player or team will have mushroom shaped base.  At the beginning of a match, you can choose between three base starting positions or a fourth choice to set custom base positions (follow the on screen instructions).  On race courses, only custom base positions are allowed.  The bases and flag positions are all visible as icons on the minimap.  To score, a player must pick up a flag by driving into it, and then bring the flag back to their base.  You will hear a coin sound when you pick up a flag or score.  Flag carriers will have an arrow over their head to show their location to other players.  If a flag carrier is hit, the flag will drop onto the course for a brief period of time.  If a dropped flag is not picked up after a short period of time, it will respawn.  In single flag mode, there is only flag.  It will spawn in random locations in battle courses, or near the starting line in race courses.  In multi-flag mode, each player or team will have a flag next to their base that can be captured. You can't capture your own flag, but you can pick it up if it falls onto the course to return it to your base.  There are two options that affect a player holding a flag that are normally turned off.  One makes it so flag carriers cannot use items, and another makes flag carriers move slower.

Keep Away:
This mode is similar to Capture The Flag, except there are no bases.  The flag position is visible as an icon on the minimap and will spawn in a random location on battle courses, or near the starting line on a race course.  There is only one flag and each player or team must try to hold the flag as long as possible.  Every few seconds the player or team are holding the flag gains a point.    If you are hit, the flag will drop and someone else can pick it up.  If no on picks it up after a short time, it will respawn.  If you are the flag holder, you want to keep the flag as long as possible.  If someone else has the flag, you will want to hit them and steal the flag.  Flag carriers will have an arrow over their head for other players to see.  As with Capture the Flag, there are two options that affect a player holding a flag that are normally turned off.  One makes flag carriers cannot use items, and another makes flag carriers move slower.

Zombombs:
This is zombie infection, but with bob-ombs!  There are two teams: survivors and bombs.  At the beginning of the game a random player will be turned into a bomb, and everyone else are the survivors.  There will be a countdown timer on ther screen.  The goal of the bombs is to turn everyone else into bombs by running into the them.  The goal of the survivors is to try to keep from getting hit by the bombs and stay alive until the timer reaches zero.  Bombs can be stunned briefly with shells and other items, but cannot be killed.  If at least one survivor is still alive when the timer reaches zero, the survivors win.  If everyone gets turned into bombs before the timer reaches zero, the game ends and the bombs win.  There will be text on the results screen saying which team won.

Shell Shooter:
This game mode turns Mario Kart 64 into something like Battlezone or First Person Shooter! It changes the camera to first person mode, and you must drive around and shoot the opposing players or team with green shells.  The shells will not bounce off of walls in this game mode, hence they act more like bullets.  You have a limited amount of ammunition (green shells) and the green bar on your screen shows how much ammo you remaining.  Run into item boxes to pick up more ammunition.  A red bar on your screen shows your health.  Every time you are hit, you will lose a bit of health.  When your health bar reaches zero, you will  lose 1 HP or the opposing player or team that hit you last will gain a point.  For a more FPS like experience, turn on Respawn in the Options menu.  

=================================================

FREE FOR ALL OR TEAMS

Free for all (FFA):
This is where each player is trying to win themselves.

Teams:
This scoring mode splits players into two teams for 2 vs. 1 or 2 vs. 2.  Team 1 are players on controller ports 1 and 2.  Team 2 are the players on controller port(s) 3 (and 4).   HP or points are shared between teammates.

=================================================

SCORING

There are three different types of scoring modes.

Stock:
Stock scoring uses hit points (HP).  Each player has a limited amount of hit points (HP), which you can set in the menu.  If you take damage, you lose 1 HP.  If your HP reaches zero, you are dead.  When there are more than two players, dead players become bombs who can run into a still living opponent.  Once you run into someone as a bomb, you are done.  The last player standing wins.  In Traditional battle mode, if the HP is set to 3 or less, the normal balloons are used.  In teams mode, HP is shared between teammates.  Beware of friendly fire as you can hit your own teammate.

Timer:
There is a timer displayed near the center of the screen with a set number of minutes which you can change in the menu, that counts down to 0:00.  When the timer reaches zero, the player or team with the greatest number of points wins.  In the menu there are two options on how to set the score, "-1 WHEN HIT" means that if you are hit, you lose one point and "+1 HIT ENEMY" means you gain a point if you hit an enemy.  One or both of these options can be set, depending on your preference.  Points can go negative.  The game modes CTF and Keep Away are objective based so only let you earn points.  If there is a tie when the timer reaches zero, the game will go to Sudden Death where those who are tied must continue to play until someone scores a point and wins.  When playing as a team, teammates share the same score. Note that riendly fire will not gain you points, but you your team lose a point if  "-1 WHEN HIT" is set ON.


Points:
You earn points when you hit other players, or for succeeding in your objective in CTF and Keep Away.  The player or team that reaches the maximum amount of points first wins.  The max points can be set in the menu.  You can set "-1 WHEN HIT" in the menu to take away 1 point when hit.  Note that friendly fire will not gain you points, but your team will lose a point if  "-1 WHEN HIT" is set ON.


=================================================

CPU BOTS

Battle Kart includes a menu to turn players into CPU controlled bots.   Finally you can play battle mode, even if you have no friends. Coding them has been a supreme challenge but now with pathfinding we hope that the bots will prove much more intelligent to play against.  In the bot menu, you select which player you want to be a bot, and select which character you want the bot to be. Bots will follow predefined paths around each course, grab items from item boxes, and seek out rivals.  They do know how to play Capture The Flag and Keep Away! They will grab a flag and bring it back to their base in Capture The Flag and try to hold onto the flag as long as possible in Keep Away.  

There are two bot AI types:
-Seeker: These bots will use path finding, grab items from item boxes, and seek out their enemies on the course.  This is the recommended bot AI setting.
-Random: The bots will randomly drive around.  Dumb and easy to beat.  

Bots can't fall:
The bots are pretty dumb so normally they will drive off a course such as Big Donut or Skyscraper.  This option causes them to respawn if they fall off the course in a position they were at a second before, making Big Donut, Skyscraper, and many race courses playable with bots.  It is on by default, but can be disabled.

Bots use items:
Normally the bots will use items, but if for some reason you want to make them harmless, you can turn their item use off.

1P Full Screen:
Normally in Battle Mode you see all the player's screens.  Turning this option on makes it so only player 1's screen is displayed.  Useful if you are only playing against bots and want to use the whole screen, and not look at the bots' screens.  This mode is experimental so you might run into bugs.  Please report any you find.

=================================================

ADDITIONAL OPTIONS

Respawn: 
If you turn this on, Lakitu will grab you after you take a hit and you will respawn.  This option was added to make the gameplay more resemble First Person Shooters.

Item toggling:
All the items used in battle mode (bananas, banana bunches, green shells, triple green shells, red shells, fake item boxes, stars, and ghosts) can be toggled on or off like in Super Smash Bros.

Auto Items:
Turning on "Auto Items" will give all players items at random intervals without the need to hit an item box.  This can be useful when playing on race courses or if you just don't want to deal with having to run into item boxes to get items. 

Infinite Green Shells:
Each player can fire an infinite number of green shells.  No other items are useable with this is on.  Note that there is a maximum number of shells that can be on the course at any one time, so "infinite green shells" is best played on a course where the shells can fall off such as Big Donut or Skyscraper.  It also goes well with "flattened courses".

Flat Courses:
This option makes all courses flat.  It is almost like playing new courses!  Works best for Block Fort.  The item box heights have been adjusted to match the flat course height for all courses.

Widescreen:
Turning this option on changes the graphics to 16:9 anamorphic widescreen.  Useful for playing on modern TVs.  Note that this might introduce a small amount of lag on console.

Antialiasing:
Normally most N64 games apply a software antialiasing filter to the graphics to smooth out the jagged edges. Mario Kart 64 has the antialiasing on by default. Turning the antialiasing off results in sharper more "pixelated" graphics you might prefer on a modern screen.  Disabling the antialiasing also reduces the lag in the game, so if you want to improve the FPS, try turning the antialiasing off.

3P/4P Music:
This option enables the game music in 3 and 4 player modes.  On console, it adds a small amount of lag.

Same Chars:
This option allows multiple players to select the same character.   Useful if you want to be a character already used by a bot.

Game Tempo:
The game tempo sets the game's frames per second (FPS) to ensure the game runs at a reasonable pace.  On emulator it should be set to "30 FPS".  On console this should be set to "DEFAULT" so that the tempo is automatically adjusted depending on the course and number of players.   The game will attempt to detect if it is on console or emulator and set this option accordingly, but this doesn't always work so you should double check the value yourself.  You can also adjust it manually if you want to DEFAULT, 15 FPS, 20 FPS, 30 FPS, or 60 FPS.  If you find the game is lagging, you can try lowering the FPS.  The 60 FPS option is experimental and designed to work in emulators.  In 60 FPS mode, some animations are double speed.  On console, the game will run slowly in this mode.  Read more about the game tempo and lag frames here: http://tasvideos.org/GameResources/N64/MarioKart64/Patches.html

Minimap:
This option lets you disable the in game minimap.  It is on by default.

Ludicrous Speed:
Turning this option on will make the top speed of all players very fast.

=================================================

PLAYING BATTLE MODE ON RACE COURSES

You are no longer just limited to playing on four battle courses.  Now you can play battle mode on the game's 16 race courses as well.  Simply select VS instead of Battle, select 50CC, 100CC, 150CC or Extra, and then select the course you want to play on.  It's as simple as that!

=================================================


TROUBLESHOOTING

BATTLE KART 64 REQUIRES THE EXPANSION PAK:
If it doesn't boot first make sure your console has an Expansion Pak installed, or the emulator you are using has it enabled.

UNABLE TO SEE TEXT IN EMULATOR:
If you have trouble seeing the text in an emulator, try changing the video plugin your emulator is using.

WILL NOT RUN ON THE WII:
To fix BattleKart64 on Wii64, set the option "LimitVIs = 2" on settings.cfg.  
To fix BattleKart64 on Not64, change the  Speed Limit from VI to DL or Off.
Thanks to VeliZer0 for finding these fixes.
I have not tried VC injection so if anyone gets that to work, please let me know.

HP NOT DISPLAYING:
Note that the HP will not display in traditional battle mode if it is set less than or equal to 3.  This is a feature, not a bug.  The game will use the balloons to track your HP.